{% extends "base.html" %}

{% block content %}
<div class="space-y-4">
  <section class="card p-5">
    <div class="flex items-center justify-between gap-3">
      <h1 class="text-lg font-semibold text-slate-900">系统配置</h1>
      <p class="text-sm text-slate-500">配置 SMTP 参数与日志记录规则</p>
    </div>

    {% if saved %}
      <div class="mt-4 rounded-md border border-blue-100 bg-blue-50 px-3 py-2 text-sm text-blue-600">
        配置已保存。
      </div>
    {% endif %}

    <form class="mt-4 grid gap-5" method="post" action="/admin/config">
      <div>
        <h2 class="text-base font-semibold text-slate-900">SMTP 邮件配置</h2>
        <p class="mt-1 text-sm text-slate-500">用于通知、告警或重置密码等邮件发送。</p>
      </div>

      <div class="grid gap-4 md:grid-cols-2">
        <div>
          <label class="label">SMTP 主机</label>
          <input name="smtp_host" class="input" value="{{ smtp.smtp_host }}" />
        </div>
        <div>
          <label class="label">SMTP 端口</label>
          <input name="smtp_port" class="input" value="{{ smtp.smtp_port }}" />
        </div>
        <div>
          <label class="label">SMTP 用户名</label>
          <input name="smtp_user" class="input" value="{{ smtp.smtp_user }}" />
        </div>
        <div>
          <label class="label">SMTP 密码</label>
          <input name="smtp_pass" type="password" class="input" value="{{ smtp.smtp_pass }}" />
        </div>
        <div>
          <label class="label">发件人地址</label>
          <input name="smtp_from" class="input" value="{{ smtp.smtp_from }}" />
        </div>
        <div>
          <label class="label">启用 SSL (true/false)</label>
          <input name="smtp_ssl" class="input" value="{{ smtp.smtp_ssl }}" />
        </div>
      </div>

      <div class="border-t border-slate-100 pt-5">
        <h2 class="text-base font-semibold text-slate-900">日志记录类型</h2>
        <p class="mt-1 text-sm text-slate-500">选择需要写入操作日志页面的增删改查类型。</p>

        <div class="mt-3 grid gap-3 md:grid-cols-4">
          {% for key, label in audit_action_labels.items() %}
            <label class="flex items-center gap-2 rounded-md border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700">
              <input
                type="checkbox"
                name="audit_actions"
                value="{{ key }}"
                class="h-4 w-4 rounded border-slate-300 text-blue-600 focus:ring-blue-500"
                {% if key in audit_actions %}checked{% endif %}
              />
              <span>{{ label }}</span>
            </label>
          {% endfor %}
        </div>
      </div>

      <div class="flex justify-end">
        <button type="submit" class="btn-primary">保存配置</button>
      </div>
    </form>
  </section>
</div>
{% endblock %}
