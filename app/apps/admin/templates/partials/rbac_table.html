<div id="rbac-table" class="space-y-4">
  {% if items %}
    <div class="hidden overflow-hidden rounded-2xl border border-black/10 bg-white/80 md:block">
      <table class="w-full text-left text-sm">
        <thead class="bg-black/5 text-xs uppercase tracking-widest text-muted">
          <tr>
            <th class="px-4 py-3">角色</th>
            <th class="px-4 py-3">资源</th>
            <th class="px-4 py-3">负责人</th>
            <th class="px-4 py-3">优先级</th>
            <th class="px-4 py-3">状态</th>
            <th class="px-4 py-3">更新时间</th>
            <th class="px-4 py-3 text-right">操作</th>
          </tr>
        </thead>
        <tbody>
          {% for item in items %}
            {% set meta = status_meta[item.status] %}
            <tr class="border-t border-black/5">
              <td class="px-4 py-3 font-semibold text-ink">
                <div>{{ item.role_name }}</div>
                <div class="text-xs text-muted">{{ item.role_key }}</div>
              </td>
              <td class="px-4 py-3">
                <div class="font-semibold text-ink">{{ item.resource }}</div>
                <div class="text-xs text-muted">{{ item.action }}</div>
              </td>
              <td class="px-4 py-3 text-muted">{{ item.owner }}</td>
              <td class="px-4 py-3">
                <span class="tag">{{ priority_meta[item.priority] }}</span>
              </td>
              <td class="px-4 py-3">
                <span class="tag" style="border-color: {{ meta.color }}; color: {{ meta.color }};">
                  {{ meta.label }}
                </span>
              </td>
              <td class="px-4 py-3 text-muted">{{ item.updated_at | fmt_dt }}</td>
              <td class="px-4 py-3 text-right">
                <div class="flex justify-end gap-2">
                  <button
                    class="btn-ghost px-3"
                    hx-get="/admin/rbac/{{ item.id }}/edit"
                    hx-target="#modal-body"
                    hx-swap="innerHTML"
                    x-on:click="modalOpen = true"
                  >
                    编辑
                  </button>
                  <button
                    class="btn-ghost px-3"
                    hx-delete="/admin/rbac/{{ item.id }}"
                    hx-target="#rbac-table"
                    hx-swap="outerHTML"
                    hx-confirm="确认删除该条记录吗？"
                    hx-indicator="#global-indicator"
                  >
                    删除
                  </button>
                </div>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="grid gap-4 md:hidden">
      {% for item in items %}
        {% set meta = status_meta[item.status] %}
        <div class="card p-4">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm text-muted">{{ item.role_key }}</p>
              <p class="text-lg font-semibold text-ink">{{ item.role_name }}</p>
            </div>
            <span class="tag" style="border-color: {{ meta.color }}; color: {{ meta.color }};">
              {{ meta.label }}
            </span>
          </div>
          <div class="mt-3 text-sm text-muted">
            <p>负责人：{{ item.owner }}</p>
            <p>资源：{{ item.resource }} · 动作：{{ item.action }}</p>
          </div>
          <div class="mt-3 flex flex-wrap gap-2">
            <span class="tag">{{ priority_meta[item.priority] }}</span>
            {% for tag in item.tags %}
              <span class="tag">{{ tag }}</span>
            {% endfor %}
          </div>
          <div class="mt-4 flex gap-2">
            <button
              class="btn-ghost flex-1"
              hx-get="/admin/rbac/{{ item.id }}/edit"
              hx-target="#modal-body"
              hx-swap="innerHTML"
              x-on:click="modalOpen = true"
            >
              编辑
            </button>
            <button
              class="btn-ghost flex-1"
              hx-delete="/admin/rbac/{{ item.id }}"
              hx-target="#rbac-table"
              hx-swap="outerHTML"
              hx-confirm="确认删除该条记录吗？"
              hx-indicator="#global-indicator"
            >
              删除
            </button>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="card p-10 text-center">
      <p class="font-display text-2xl text-ink">暂无 RBAC 数据</p>
      <p class="mt-2 text-sm text-muted">可以通过“新建 RBAC”快速添加一条记录。</p>
      <button
        class="btn-primary mt-6"
        hx-get="/admin/rbac/new"
        hx-target="#modal-body"
        hx-swap="innerHTML"
        hx-indicator="#global-indicator"
        x-on:click="modalOpen = true"
      >
        立即新建
      </button>
    </div>
  {% endif %}
</div>
